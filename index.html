<!DOCTYPE html>
<html lang="en">

<head>
  <!--   Call this script to enable A-Frame   -->
  <!--   Future through Memory AFrame Blank Code  -->
  
  <script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-pointcloud-component/dist/aframe-pointcloud-component.min.js"></script>
  <script src="js/aframe-tooltip-component.js"></script>
  <script src="js/link-controls.js"></script>
  <!-- <script src="https://unpkg.com/aframe-simple-sun-sky@^1.2.2/simple-sun-sky.js"></script> -->
  
</head>

<body>
  <!--   Place <a-scene> and <a-assets> inside your <body>   -->
  <a-scene>
    <a-assets>
      
      <!-- Images for sky and ground entity -->
      <img crossorigin="anonymous" id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg">
      <img crossorigin="anonymous" id="skyTexture" src="assets/sky.png">
    <!-- <img id="sky" src="sky.png"> -->

 
     

      <!-- Add your 2D Images Here -->
      <img id="Chinatowngate-360-Dec27" src="assets/Chinatowngate-360-Dec27.jpg">
      <img id="Facade-galaxy" src="assets/Facade-galaxy.jpg">
      <img id="Facade-BBQ" src="assets/Facade-BBQ.jpg">
      <img id="Facade-closedbuilding" src="assets/Facade-closedbuilding.jpg">
      <img id="souvenir-2" src="assets/souvenir-2.jpg">
      <img id="1990" src="assets/1990.png">
      <img id="2020" src="assets/2020.png">
      <img id="broadview-intersection" src="assets/broadview-intersection.jpg">

      <img id="baby" src="assets/baby.png">
      <img id="1990-corner" src="assets/1990-corner.png">
      <img id="1990-restaurantsignage" src="assets/1990-restaurantsignage.png">
      <img id="1990-restaurantfront" src="assets/1990-restaurantfront.png">



     
      <!-- Add Your OBJ, MTL and PLY Files Here -->
      <!-- <a-asset-item id="PointCloudName" src="assets/360Gate-Nov29.ply"></a-asset-item> -->
      <a-asset-item id="OBJName" src="assets/Chinatowngate-360-Dec27.obj"></a-asset-item>
      <a-asset-item id="MTLName" src="assets/Chinatowngate-360-Dec27.mtl"></a-asset-item>

      <!-- <a-asset-item id="PointCloudName2" src="assets/souvenir2.ply"></a-asset-item> -->
      <a-asset-item id="OBJName2" src="assets/souvenir-2.obj"></a-asset-item>
      <a-asset-item id="MTLName2" src="assets/souvenir-2.mtl"></a-asset-item>

      <a-asset-item id="OBJName2" src="assets/Facade-closedbuilding.obj"></a-asset-item>
      <a-asset-item id="MTLName2" src="assets/Facade-closedbuilding.mtl"></a-asset-item>

      <a-asset-item id="OBJName2" src="assets/Facade-BBQ.obj"></a-asset-item>
      <a-asset-item id="MTLName2" src="assets/Facade-BBQ.mtl"></a-asset-item>

      <a-asset-item id="OBJName2" src="assets/Facade-galaxy.obj"></a-asset-item>
      <a-asset-item id="MTLName2" src="assets/Facade-galaxy.mtl"></a-asset-item>
  

      <!-- Add Your Audio Files, Keep "Steps" File -->
      <audio id="chinatown" src="assets/chinatown.flac" preload="auto" autoplay loop="true"
               crossOrigin="anonymous" volume="2"></audio>    

    
      <video id="birds" preload="auto" src="assets/birds.mp4" width="160" height="90" autoplay loop="true"
               crossOrigin="anonymous" muted></video>
       

    

    </a-assets>

    
    <!-- Entities -->

    
    </a-assets>

    <a-entity camera="" position="17.4 1.6 0" wasd-controls="" rotation="-3.2 88 0" look-controls="" aframe-injected="" data-aframe-inspector-original-camera="" visible=""></a-entity>

    <a-entity obj-model="mtl:assets/Chinatowngate-360-Dec27.mtl;obj:assets/Chinatowngate-360-Dec27.obj" position="1.5 1 -24" rotation="7 180 -721" scale="0.5 0.42 0.53"></a-entity>


    <a-entity obj-model="mtl:assets/souvenir-2.mtl;obj:assets/souvenir-2.obj" position="7.772 7.447 -11.575" rotation="-26.39 564 0.8" scale="1 1 1"></a-entity>

    <a-entity obj-model="mtl:assets/Facade-closedbuilding.mtl;obj:assets/Facade-closedbuilding.obj" position="-2.5 1.76 -25.5" rotation="363 250 -3.2" scale="0.8 1 1"></a-entity>

    <a-entity obj-model="mtl:assets/Facade-BBQ.mtl;obj:assets/Facade-BBQ.obj" position="8.5 2.22 -21.4" rotation="0 435 8.4" scale="1 1 1"></a-entity>

    <a-entity obj-model="mtl:assets/Facade-galaxy.mtl;obj:assets/Facade-galaxy.obj" position="-11.95 -0.1 -14.8" rotation="375.48 -42 -12.7" scale="0.25 0.25 0.25"></a-entity>


    

    <a-entity material="shader: flat; src: #birds"
                geometry="primitive: plane; width: 160; height: 90;"
                position="-0.4 1.5 -11.5"
                rotation="4.47 -10 -90"
                scale="0.018 0.02 0"
                play-on-click
                visible="true">
      </a-entity>


     <!-- Position Your Images -->
    
    <a-image src="#1990" position="-4.576 0.866 -1.893" geometry="width:1.5" scale="1.5 1.5 3" rotation="2.6499999999999995 34.72 -1.8"></a-image>
    <a-image src="#2020" position="4.7 0.8 -19" material="" geometry="width:1.5" scale="1.5 1.5 3" rotation="0 -15 0"></a-image>
    <a-image src="#broadview-intersection" position="-3.3 2 -20.1" material="" geometry="width:1.5" scale="4 5 4" rotation="-0.7 35 0"></a-image>


    <!-- <a-image src="#baby" position="4.3 1.1 -6.53" material="" geometry="width:1.5" scale="1.2 3 3" rotation="-8.24 -51 95"></a-image> -->
    <a-image src="#1990-corner" position="-4.2 2.3 -5.25" material="" geometry="width:1.5" scale="4 4 4" rotation="0 45 0"></a-image>
    <a-image src="#1990-restaurantsignage" position="7.3 1.5 1.452" geometry="width:1.5" scale="3 4 3" rotation="-0.7 100 0"></a-image>
    <a-image src="#1990-restaurantfront" position="5.640000000000001 2.037 -3.231" geometry="width:1.5" scale="4 4 3" rotation="-1.75 -69 0"></a-image>

   <!-- Additional Matrial - Do Not Touch -->
    <a-entity id="streetcarEnt" sound="src: assets/streetcar.m4a; volume: 2; loop: true; poolSize: 1;" ></a-entity>
    <a-plane src="#groundTexture" rotation="-90 0 0" height="100" width="100"></a-plane>
    <a-light type="ambient" color="#445451" light="groundColor: #2b2727; intensity: 0.5; penumbra: 0.58; castShadows: false" visible="" rotation="" position="0.07 0 0" scale=""></a-light>

    <a-light type="point" intensity="1" position="2 5.351 1.769" scale="300 300 300" light="decay:-8.7;penumbra:1;distance:98.99;type:hemisphere"></a-light>


    <!-- <a-light type="point" intensity="1" position="2 4 4"></a-light> -->
    <a-sky height="2048" radius="30" src="#skyTexture" theta-length="90" width="3048" colour="#5C7EB6" 	fog-color="#5C7EB6"></a-sky>
 



      <a-camera>
        <a-entity
          position="15.83 1.6 0"
          rotation="0 90 0"
          text="align: center;
                width: 6;
                wrapCount: 100;
                color: black;"
                hide-on-play="#birds">
        </a-entity>
      </a-camera>
  



  </a-scene>
</body>

<script> //walking steps
  document.addEventListener("DOMContentLoaded", function(event){
    var cameraEl = document.querySelector("#camera");
    var walking = document.querySelector("#chinatown");

    function walkingSound() {
      walking.components.sound.playSound();
      console.log('walk');
    }

    function walkingSoundStop() {
      walking.components.sound.pauseSound();
      console.log('stop');
    }

    document.addEventListener("keydown", function(evt) {
        // check if keys pressed are W, A, S, D and Up, Down, Left, Right
        if (evt.keyCode == 87 || evt.keyCode == 65 || evt.keyCode == 83 || evt.keyCode == 68 || evt.keyCode == 38 || evt.keyCode == 37 || evt.keyCode == 39 || evt.keyCode == 40)
        {
          walkingSound();
        }
    });     
    document.addEventListener("keyup", function(evt) {
        // check if keys pressed are W, A, S, D and Up, Down, Left, Right
        if (evt.keyCode == 87 || evt.keyCode == 65 || evt.keyCode == 83 || evt.keyCode == 68 || evt.keyCode == 38 || evt.keyCode == 37 || evt.keyCode == 39 || evt.keyCode == 40)
        {
          walkingSoundStop();
        }
    }); 
});


  AFRAME.registerComponent('play-on-click', {
  init: function () {
    this.onClick = this.onClick.bind(this);
  },
  play: function () {
    window.addEventListener('click', this.onClick);
  },
  pause: function () {
    window.removeEventListener('click', this.onClick);
  },
  onClick: function (evt) {
    var videoEl = this.el.getAttribute('material').src;
    if (!videoEl) { return; }
    this.el.object3D.visible = true;
    videoEl.play();
  }
});
</script>

</html>